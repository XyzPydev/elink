:root{
  --bg:#0f1720;
  --panel:#0b1220;
  --muted:#9aa4b2;
  --accent:#4ea1ff;
  --me-bg:#154733;   /* темно-зелений для своїх повідомлень */
  --other-bg:#0b1622; /* трохи світліше для чужих */
  --text:#e6eef6;
  font-family: Inter, Roboto, Arial, sans-serif;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text)}
.app{display:flex;height:100vh;align-items:stretch}
.sidebar{width:320px;background:var(--panel);border-right:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column;padding:12px;gap:12px}
.sidebar-header{display:flex;justify-content:space-between;align-items:center}
.me .email{font-size:12px;color:var(--muted)}
.logout{font-size:13px;color:var(--accent);text-decoration:none}
.search .search-form{display:flex;gap:8px}
.search input{flex:1;padding:8px;border:1px solid rgba(255,255,255,0.03);border-radius:6px;background:transparent;color:var(--text)}
.search button{padding:8px 10px;border-radius:6px;border:0;background:var(--accent);color:white}
.chats-list{overflow:auto;flex:0 0 auto}
.chats-list h4{margin:8px 0 6px 0;color:var(--muted);font-weight:600}
.chat-item{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;text-decoration:none;color:inherit;margin-bottom:6px}
.chat-item:hover{background:rgba(78,161,255,0.06)}
.chat-item.active{background:rgba(78,161,255,0.08);border-left:3px solid var(--accent);padding-left:6px}
.chat-meta{display:flex;flex-direction:column}
.chat-name{font-weight:600}
.chat-preview{font-size:13px;color:var(--muted)}
.chat-time{font-size:12px;color:var(--muted)}
.users-list{margin-top:auto}
.users-list ul{list-style:none;padding:0;margin:6px 0 0 0}
.users-list li{margin-bottom:6px}
.users-list a{color:inherit;text-decoration:none;font-size:14px}

.main-empty{flex:1;display:flex;align-items:center;justify-content:center}
.empty-state{background:var(--panel);padding:40px;border-radius:12px;box-shadow:0 4px 30px rgba(0,0,0,0.6)}

.chat-main{flex:1;display:flex;flex-direction:column}
.chat-header{padding:16px;border-bottom:1px solid rgba(255,255,255,0.03);background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);display:flex;align-items:center;gap:12px}
.messages{flex:1;padding:18px;overflow:auto;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent)}
.message{max-width:70%;margin-bottom:12px;display:flex}
.from-me{margin-left:auto;justify-content:flex-end}
.msg-content{background:var(--other-bg);padding:10px 12px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.6);color:var(--text)}
.from-me .msg-content{background:var(--me-bg)}
.msg-text{white-space:pre-wrap}
.msg-meta{font-size:11px;color:var(--muted);margin-top:6px;display:flex;gap:8px}
.composer{display:flex;padding:12px;border-top:1px solid rgba(255,255,255,0.03);background:linear-gradient(180deg, transparent, rgba(0,0,0,0.2))}
.composer input{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);margin-right:8px;background:transparent;color:var(--text)}
.composer button{padding:10px 14px;border-radius:8px;border:0;background:var(--accent);color:white}
.small{font-size:12px;color:var(--muted)}
/* Mobile responsiveness */
@media (max-width: 900px) {
  .app { flex-direction: column; }
  .sidebar { width:100%; height:64px; display:flex; align-items:center; padding:8px; gap:12px; position:fixed; top:0; left:0; right:0; z-index:1000; }
  .chat-main { margin-top:64px; }
  .sidebar .chats-list, .sidebar .users-list, .search { display:none; }
  .composer { position:fixed; left:0; right:0; bottom:0; padding:10px; z-index:1000; background:var(--panel); border-top:1px solid rgba(255,255,255,0.03); }
  .messages { padding-bottom:110px; } /* space for composer */
  .msg-content img.chat-image, .msg-content audio { max-width:100%; }
}

/* ensure images/audio responsive */
.msg-content img.chat-image { max-width:60%; height:auto; }
.msg-content audio { width:100%; max-width:60%; }
@media (max-width:900px){
  .msg-content img.chat-image, .msg-content audio { max-width:100%; }
}
/* File picker */
.file-input-wrapper { display:inline-flex; align-items:center; gap:8px; }
.file-label { display:inline-flex; align-items:center; gap:8px; padding:8px 10px; border-radius:8px; background:rgba(255,255,255,0.03); cursor:pointer; border:1px solid rgba(255,255,255,0.02); color:var(--text); }
.file-label:hover { background:rgba(255,255,255,0.04); }
.file-name { font-size:13px; color:var(--muted); margin-left:6px; max-width:160px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }

/* Tiny avatars in chat list */
.chat-item .avatar-xs { width:36px; height:36px; border-radius:8px; object-fit:cover; margin-right:10px; vertical-align:middle; }

/* Profile panel */
#profile_panel { transition: all .12s ease; }
#profile_panel .avatar-lg { width:80px; height:80px; object-fit:cover; border-radius:12px; display:block; margin-bottom:8px; }
#profile_panel .username { font-weight:700; font-size:16px; }
#profile_panel .status { font-size:13px; color:var(--muted); margin-bottom:8px; }
#profile_panel .action-btn { display:inline-block; padding:8px 10px; border-radius:8px; background:var(--accent); color:#fff; text-decoration:none; margin-right:8px; }
.avatar-sm {
  width: 40px;
  height: 40px;
  border-radius: 8px;
  object-fit: cover;       /* crop to fit */
  display: inline-block;
  vertical-align: middle;
}

/* tiny avatar in chat list / users list */
.avatar-xs {
  width: 36px;
  height: 36px;
  border-radius: 8px;
  object-fit: cover;
  display: inline-block;
  vertical-align: middle;
}

/* large avatar in profile panel */
.avatar-lg {
  width: 80px;
  height: 80px;
  border-radius: 12px;
  object-fit: cover;
  display: block;
}

/* ensure avatar <img> won't exceed container on small screens */
.sidebar .avatar-sm, .chat-item .avatar-xs, #profile_panel .avatar-lg {
  max-width: 100%;
  height: auto; /* preserve aspect ratio if needed, but object-fit keeps crop */
}

/* For message images: max dimensions and cover behavior */
.msg-content img.chat-image {
  max-width: 60%;
  max-height: 60vh; /* prevent huge images on tall screens */
  width: auto;
  height: auto;
  border-radius: 8px;
  object-fit: cover;
  display: block;
  margin-bottom: 6px;
  cursor: pointer;
}

/* On mobile make message images full-width */
@media (max-width:900px) {
  .msg-content img.chat-image {
    max-width: 100%;
    max-height: 50vh;
  }
  /* ensure audio controls not overflow */
  .msg-content audio { width: 100%; max-width: 100%; }
}

/* If some avatars come as large images, force them to fit box */
.avatar-sm, .avatar-xs, .avatar-lg {
  background-color: rgba(255,255,255,0.02);
  overflow: hidden;
  display: inline-block;
}

/* Optional: hide broken images gracefully */
img { max-width: 100%; }
img[alt="avatar"] { object-fit: cover; }

/* ---- UI variables already exist in your file (kept) ---- */
/* Add these blocks to the end of your existing stylesheet */

/* Container for auth forms */
.chat-container {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
}

/* Card */
.auth-card {
  width: 420px;
  max-width: calc(100% - 48px);
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,255,255,0.03);
  border-radius: 12px;
  padding: 28px;
  box-shadow: 0 8px 40px rgba(2,6,23,0.6);
  color: var(--text);
  transform-origin: 50% 10%;
  animation: cardEnter 420ms cubic-bezier(.2,.95,.15,1);
}

/* header inside auth */
.auth-card .chat-header { margin-bottom: 14px; display:flex; align-items:center; gap:12px; }
.auth-card .chat-header h2 { margin:0; font-size:20px; letter-spacing:0.2px; }

/* form layout */
.auth-form { display:flex; flex-direction:column; gap:12px; }
.input-group { position:relative; }
.auth-form input[type="email"],
.auth-form input[type="text"],
.auth-form input[type="password"] {
  width:100%;
  padding:12px 12px 12px 12px;
  border-radius:8px;
  border:1px solid rgba(255,255,255,0.04);
  background:transparent;
  color:var(--text);
  outline: none;
  transition: box-shadow .18s ease, border-color .18s ease, transform .18s ease;
  font-size:15px;
}

/* floating label */
.input-group label {
  position:absolute;
  left:12px;
  top:12px;
  pointer-events:none;
  font-size:13px;
  color:var(--muted);
  transform-origin:left top;
  transition: transform .18s ease, top .18s ease, font-size .18s ease, color .18s ease;
  background:transparent;
  padding:0 4px;
}

/* when input focused or has value */
.input-group input:focus {
  border-color: rgba(78,161,255,0.9);
  box-shadow: 0 6px 24px rgba(78,161,255,0.06), inset 0 0 0 1px rgba(78,161,255,0.03);
  transform: translateY(-1px);
}
.input-group input:focus + label,
.input-group.has-value label {
  transform: translateY(-10px) scale(.89);
  top:6px;
  color: var(--accent);
  font-size:12px;
}

/* subtle invalid (shake) state */
.input-group.invalid input {
  animation: shake .32s ease;
  border-color: #ff6b6b;
  box-shadow: 0 6px 20px rgba(255,107,107,0.06);
}
.input-error {
  color:#ff8b8b;
  font-size:12px;
  margin-top:6px;
}

/* submit button with spinner */
.auth-actions { display:flex; align-items:center; gap:12px; margin-top:6px; }
.btn {
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:10px 14px;
  border-radius:10px;
  border:0;
  background:var(--accent);
  color:white;
  cursor:pointer;
  font-weight:600;
  min-width:120px;
  position:relative;
  overflow:hidden;
  transition: transform .12s ease, box-shadow .12s ease, opacity .12s ease;
}
.btn:active { transform: translateY(1px) scale(.995); }
.btn[disabled] { opacity:.7; cursor:wait; transform:none; }

/* spinner (hidden by default) */
.btn .spinner {
  width:18px;
  height:18px;
  border-radius:50%;
  border:2px solid rgba(255,255,255,0.18);
  border-top-color:white;
  animation: spin 0.9s linear infinite;
  display:inline-block;
  margin-right:8px;
}

/* When form submitting, show spinner and compress button text */
.auth-form.submitting .btn .btn-text { opacity:0; transform: translateY(-4px); }
.auth-form.submitting .btn .spinner { opacity:1; transform:none; }

/* success check animation overlay */
.auth-success {
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  pointer-events:none;
}
.checkmark {
  width:76px;
  height:76px;
  border-radius:50%;
  background:linear-gradient(135deg, rgba(78,161,255,0.12), rgba(78,161,255,0.08));
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:0 8px 24px rgba(2,6,23,0.6);
  transform: scale(.92);
  animation: popIn .42s cubic-bezier(.2,.9,.25,1) forwards;
}
.checkmark svg { width:42px; height:42px; stroke:var(--accent); stroke-width:4; fill:none; stroke-linecap:round; stroke-linejoin:round; }

/* small helper text */
.small-note { font-size:13px; color:var(--muted); }

/* Animations */
@keyframes cardEnter {
  from { opacity:0; transform: translateY(16px) scale(.995); }
  to   { opacity:1; transform: translateY(0) scale(1); }
}
@keyframes spin {
  to { transform: rotate(360deg); }
}
@keyframes shake {
  10%,90%{transform:translateX(-1px)}
  20%,80%{transform:translateX(2px)}
  30%,50%,70%{transform:translateX(-4px)}
  40%,60%{transform:translateX(4px)}
}
@keyframes popIn {
  from { transform: scale(.6); opacity:0 }
  to   { transform: scale(1); opacity:1 }
}

/* small responsive tweaks */
@media (max-width:480px) {
  .auth-card { padding:18px; width:100%; }
  .btn { min-width:88px; }
}

/* Center auth container perfectly */
.chat-container {
  min-height: 100vh;
  display: grid;
  place-items: center;       /* <-- вертикальне + горизонтальне центрування */
  padding: 24px;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
}

/* Make the auth card centered and compact on small screens */
.auth-card {
  width: 420px;
  max-width: calc(100% - 48px);
  margin: 0 auto;            /* center fallback */
  display: block;
}

/* Center header content */
.auth-card .chat-header {
  margin-bottom: 14px;
  display: flex;
  flex-direction: column;
  align-items: center;       /* center heading and small-note */
  gap: 6px;
  text-align: center;
}

/* Center actions (submit + link) */
.auth-actions {
  display: flex;
  gap: 12px;
  justify-content: center;   /* center the button */
  align-items: center;
  margin-top: 6px;
}

/* Footer link / note centered below the card */
.auth-footer {
  margin-top: 12px;
  text-align: center;
  color: var(--muted);
  font-size: 13px;
}

/* smaller width on narrow viewports */
@media (max-width: 480px) {
  .auth-card { width: 96%; padding: 18px; }
  .auth-actions { flex-direction: column-reverse; gap: 8px; }
  .btn { width: 100%; min-width: 0; }
}
