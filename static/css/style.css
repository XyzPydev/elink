:root{
  --bg:#0f1720;
  --panel:#0b1220;
  --muted:#9aa4b2;
  --accent:#4ea1ff;
  --me-bg:#154733;   /* темно-зелений для своїх повідомлень */
  --other-bg:#0b1622; /* трохи світліше для чужих */
  --text:#e6eef6;
  font-family: Inter, Roboto, Arial, sans-serif;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text)}
.app{display:flex;height:100vh;align-items:stretch}
.sidebar{width:320px;background:var(--panel);border-right:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column;padding:12px;gap:12px}
.sidebar-header{display:flex;justify-content:space-between;align-items:center}
.me .email{font-size:12px;color:var(--muted)}
.logout{font-size:13px;color:var(--accent);text-decoration:none}
.search .search-form{display:flex;gap:8px}
.search input{flex:1;padding:8px;border:1px solid rgba(255,255,255,0.03);border-radius:6px;background:transparent;color:var(--text)}
.search button{padding:8px 10px;border-radius:6px;border:0;background:var(--accent);color:white}
.chats-list{overflow:auto;flex:0 0 auto}
.chats-list h4{margin:8px 0 6px 0;color:var(--muted);font-weight:600}
.chat-item{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;text-decoration:none;color:inherit;margin-bottom:6px}
.chat-item:hover{background:rgba(78,161,255,0.06)}
.chat-item.active{background:rgba(78,161,255,0.08);border-left:3px solid var(--accent);padding-left:6px}
.chat-meta{display:flex;flex-direction:column}
.chat-name{font-weight:600}
.chat-preview{font-size:13px;color:var(--muted)}
.chat-time{font-size:12px;color:var(--muted)}
.users-list{margin-top:auto}
.users-list ul{list-style:none;padding:0;margin:6px 0 0 0}
.users-list li{margin-bottom:6px}
.users-list a{color:inherit;text-decoration:none;font-size:14px}

.main-empty{flex:1;display:flex;align-items:center;justify-content:center}
.empty-state{background:var(--panel);padding:40px;border-radius:12px;box-shadow:0 4px 30px rgba(0,0,0,0.6)}

.chat-main{flex:1;display:flex;flex-direction:column}
.chat-header{padding:16px;border-bottom:1px solid rgba(255,255,255,0.03);background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);display:flex;align-items:center;gap:12px}
.messages{flex:1;padding:18px;overflow:auto;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent)}
.message{max-width:70%;margin-bottom:12px;display:flex}
.from-me{margin-left:auto;justify-content:flex-end}
.msg-content{background:var(--other-bg);padding:10px 12px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.6);color:var(--text)}
.from-me .msg-content{background:var(--me-bg)}
.msg-text{white-space:pre-wrap}
.msg-meta{font-size:11px;color:var(--muted);margin-top:6px;display:flex;gap:8px}
.composer{display:flex;padding:12px;border-top:1px solid rgba(255,255,255,0.03);background:linear-gradient(180deg, transparent, rgba(0,0,0,0.2))}
.composer input{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);margin-right:8px;background:transparent;color:var(--text)}
.composer button{padding:10px 14px;border-radius:8px;border:0;background:var(--accent);color:white}
.small{font-size:12px;color:var(--muted)}
/* Mobile responsiveness */
@media (max-width: 900px) {
  .app { flex-direction: column; }
  .sidebar { width:100%; height:64px; display:flex; align-items:center; padding:8px; gap:12px; position:fixed; top:0; left:0; right:0; z-index:1000; }
  .chat-main { margin-top:64px; }
  .sidebar .chats-list, .sidebar .users-list, .search { display:none; }
  .composer { position:fixed; left:0; right:0; bottom:0; padding:10px; z-index:1000; background:var(--panel); border-top:1px solid rgba(255,255,255,0.03); }
  .messages { padding-bottom:110px; } /* space for composer */
  .msg-content img.chat-image, .msg-content audio { max-width:100%; }
}

/* ensure images/audio responsive */
.msg-content img.chat-image { max-width:60%; height:auto; }
.msg-content audio { width:100%; max-width:60%; }
@media (max-width:900px){
  .msg-content img.chat-image, .msg-content audio { max-width:100%; }
}
/* File picker */
.file-input-wrapper { display:inline-flex; align-items:center; gap:8px; }
.file-label { display:inline-flex; align-items:center; gap:8px; padding:8px 10px; border-radius:8px; background:rgba(255,255,255,0.03); cursor:pointer; border:1px solid rgba(255,255,255,0.02); color:var(--text); }
.file-label:hover { background:rgba(255,255,255,0.04); }
.file-name { font-size:13px; color:var(--muted); margin-left:6px; max-width:160px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }

/* Tiny avatars in chat list */
.chat-item .avatar-xs { width:36px; height:36px; border-radius:8px; object-fit:cover; margin-right:10px; vertical-align:middle; }

/* Profile panel */
#profile_panel { transition: all .12s ease; }
#profile_panel .avatar-lg { width:80px; height:80px; object-fit:cover; border-radius:12px; display:block; margin-bottom:8px; }
#profile_panel .username { font-weight:700; font-size:16px; }
#profile_panel .status { font-size:13px; color:var(--muted); margin-bottom:8px; }
#profile_panel .action-btn { display:inline-block; padding:8px 10px; border-radius:8px; background:var(--accent); color:#fff; text-decoration:none; margin-right:8px; }
.avatar-sm {
  width: 40px;
  height: 40px;
  border-radius: 8px;
  object-fit: cover;       /* crop to fit */
  display: inline-block;
  vertical-align: middle;
}

/* tiny avatar in chat list / users list */
.avatar-xs {
  width: 36px;
  height: 36px;
  border-radius: 8px;
  object-fit: cover;
  display: inline-block;
  vertical-align: middle;
}

/* large avatar in profile panel */
.avatar-lg {
  width: 80px;
  height: 80px;
  border-radius: 12px;
  object-fit: cover;
  display: block;
}

/* ensure avatar <img> won't exceed container on small screens */
.sidebar .avatar-sm, .chat-item .avatar-xs, #profile_panel .avatar-lg {
  max-width: 100%;
  height: auto; /* preserve aspect ratio if needed, but object-fit keeps crop */
}

/* For message images: max dimensions and cover behavior */
.msg-content img.chat-image {
  max-width: 60%;
  max-height: 60vh; /* prevent huge images on tall screens */
  width: auto;
  height: auto;
  border-radius: 8px;
  object-fit: cover;
  display: block;
  margin-bottom: 6px;
  cursor: pointer;
}

/* On mobile make message images full-width */
@media (max-width:900px) {
  .msg-content img.chat-image {
    max-width: 100%;
    max-height: 50vh;
  }
  /* ensure audio controls not overflow */
  .msg-content audio { width: 100%; max-width: 100%; }
}

/* If some avatars come as large images, force them to fit box */
.avatar-sm, .avatar-xs, .avatar-lg {
  background-color: rgba(255,255,255,0.02);
  overflow: hidden;
  display: inline-block;
}

/* Optional: hide broken images gracefully */
img { max-width: 100%; }
img[alt="avatar"] { object-fit: cover; }